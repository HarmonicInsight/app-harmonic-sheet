<Window x:Class="HarmonicSheet.Views.ContactsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="連絡先帳"
        Width="800" Height="600"
        WindowStartupLocation="CenterOwner"
        FontFamily="Yu Gothic UI, Meiryo, Segoe UI"
        FontSize="20"
        Background="#F8FAFC">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- タイトル -->
        <TextBlock Grid.Row="0"
                   Text="連絡先帳"
                   FontSize="32"
                   FontWeight="Bold"
                   Margin="0,0,0,20"/>

        <!-- 検索とグループフィルタ -->
        <Grid Grid.Row="1" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBox x:Name="SearchBox"
                     Grid.Column="0"
                     FontSize="20"
                     Padding="15,10"
                     Margin="0,0,10,0"
                     TextChanged="OnSearchTextChanged">
                <TextBox.Style>
                    <Style TargetType="TextBox">
                        <Setter Property="BorderBrush" Value="#CBD5E1"/>
                        <Setter Property="BorderThickness" Value="2"/>
                    </Style>
                </TextBox.Style>
            </TextBox>

            <ComboBox x:Name="GroupFilter"
                      Grid.Column="1"
                      FontSize="18"
                      Padding="15,10"
                      Width="150"
                      Margin="0,0,10,0"
                      SelectionChanged="OnGroupFilterChanged">
                <ComboBoxItem Content="すべて" IsSelected="True"/>
                <ComboBoxItem Content="家族"/>
                <ComboBoxItem Content="友人"/>
                <ComboBoxItem Content="病院"/>
                <ComboBoxItem Content="お店"/>
                <ComboBoxItem Content="役所"/>
                <ComboBoxItem Content="その他"/>
            </ComboBox>

            <Button Grid.Column="2"
                    Content="＋ 追加"
                    FontSize="18"
                    Padding="20,10"
                    Background="#059669"
                    Foreground="White"
                    BorderThickness="0"
                    Click="OnAddContactClick"
                    Cursor="Hand"/>
        </Grid>

        <!-- 連絡先リスト -->
        <ListBox x:Name="ContactsList"
                 Grid.Row="2"
                 FontSize="20"
                 BorderThickness="2"
                 BorderBrush="#CBD5E1"
                 SelectionChanged="OnContactSelected"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Grid Margin="10,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- お気に入りマーク -->
                        <TextBlock Grid.Column="0"
                                   Text="★"
                                   FontSize="24"
                                   Foreground="#F59E0B"
                                   Margin="0,0,10,0"
                                   Visibility="{Binding IsFavorite, Converter={StaticResource BoolToVisibilityConverter}}"/>

                        <!-- 名前とメール -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="{Binding DisplayName}"
                                       FontSize="22"
                                       FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding Email}"
                                       FontSize="16"
                                       Foreground="#64748B"/>
                        </StackPanel>

                        <!-- グループ -->
                        <Border Grid.Column="2"
                                Background="#E2E8F0"
                                CornerRadius="5"
                                Padding="10,5"
                                VerticalAlignment="Center">
                            <TextBlock Text="{Binding Group}"
                                       FontSize="14"/>
                        </Border>
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- 下部ボタン -->
        <StackPanel Grid.Row="3"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,15,0,0">

            <Button x:Name="EditButton"
                    Content="編集"
                    FontSize="18"
                    Padding="25,12"
                    Margin="0,0,10,0"
                    Background="#2563EB"
                    Foreground="White"
                    BorderThickness="0"
                    Click="OnEditContactClick"
                    IsEnabled="False"
                    Cursor="Hand"/>

            <Button x:Name="DeleteButton"
                    Content="削除"
                    FontSize="18"
                    Padding="25,12"
                    Margin="0,0,10,0"
                    Background="#DC2626"
                    Foreground="White"
                    BorderThickness="0"
                    Click="OnDeleteContactClick"
                    IsEnabled="False"
                    Cursor="Hand"/>

            <Button x:Name="SelectButton"
                    Content="この人を選ぶ"
                    FontSize="18"
                    Padding="25,12"
                    Background="#059669"
                    Foreground="White"
                    BorderThickness="0"
                    Click="OnSelectContactClick"
                    IsEnabled="False"
                    Cursor="Hand"/>
        </StackPanel>
    </Grid>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>
</Window>
