<Window x:Class="HarmonicSheet.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:HarmonicSheet.Views"
        Title="HarmonicSheet - かんたんオフィス"
        WindowState="Maximized"
        MinWidth="1200"
        MinHeight="800"
        Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <!-- ヘッダー（タブ切り替え） -->
            <RowDefinition Height="Auto"/>
            <!-- メインコンテンツ -->
            <RowDefinition Height="*"/>
            <!-- フッター（音声入力・ヘルプ） -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ========================================== -->
        <!-- ヘッダー: 大きなタブボタン -->
        <!-- ========================================== -->
        <Border Grid.Row="0"
                Background="{StaticResource SurfaceBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,0,0,2"
                Padding="10,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- ロゴ -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="HarmonicSheet"
                               Style="{StaticResource LargeTextStyle}"
                               Foreground="{StaticResource PrimaryBrush}"
                               Margin="0,0,15,0"/>
                </StackPanel>

                <!-- タブボタン -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Center">
                    <RadioButton x:Name="TabDocument"
                                 Style="{StaticResource TabButtonStyle}"
                                 IsChecked="True"
                                 Checked="OnTabChanged"
                                 GroupName="MainTabs">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" FontSize="24" Margin="0,0,8,0"/>
                            <TextBlock Text="文書"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="TabSpreadsheet"
                                 Style="{StaticResource TabButtonStyle}"
                                 Checked="OnTabChanged"
                                 GroupName="MainTabs">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE80A;" FontFamily="Segoe MDL2 Assets" FontSize="24" Margin="0,0,8,0"/>
                            <TextBlock Text="表"/>
                        </StackPanel>
                    </RadioButton>
                    <RadioButton x:Name="TabMail"
                                 Style="{StaticResource TabButtonStyle}"
                                 Checked="OnTabChanged"
                                 GroupName="MainTabs">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="&#xE715;" FontFamily="Segoe MDL2 Assets" FontSize="24" Margin="0,0,8,0"/>
                            <TextBlock Text="メール"/>
                        </StackPanel>
                    </RadioButton>
                </StackPanel>

                <!-- 設定ボタン -->
                <Button Grid.Column="2"
                        Content="&#xE713;"
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="24"
                        Background="Transparent"
                        BorderThickness="0"
                        Foreground="{StaticResource TextSecondaryBrush}"
                        Padding="10"
                        Cursor="Hand"
                        ToolTip="設定"
                        Click="OnSettingsClick"/>
            </Grid>
        </Border>

        <!-- ========================================== -->
        <!-- メインコンテンツ -->
        <!-- ========================================== -->
        <Grid Grid.Row="1">
            <!-- 文書ビュー -->
            <views:DocumentView x:Name="DocumentView"
                                Visibility="Visible"/>
            <!-- 表計算ビュー -->
            <views:SpreadsheetView x:Name="SpreadsheetView"
                                   Visibility="Collapsed"/>
            <!-- メールビュー -->
            <views:MailView x:Name="MailView"
                            Visibility="Collapsed"/>
        </Grid>

        <!-- ========================================== -->
        <!-- フッター: 音声入力・状態表示 -->
        <!-- ========================================== -->
        <Border Grid.Row="2"
                Background="{StaticResource SurfaceBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,2,0,0"
                Padding="10,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- 左: 状態表示 -->
                <TextBlock x:Name="StatusText"
                           Grid.Column="0"
                           Text="準備完了"
                           Style="{StaticResource BaseTextStyle}"
                           VerticalAlignment="Center"/>

                <!-- 中央: 音声入力ボタン -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="VoiceButton"
                            Style="{StaticResource VoiceButtonStyle}"
                            Content="&#xE720;"
                            ToolTip="音声入力（クリックして話す）"
                            Click="OnVoiceInputClick"/>
                    <TextBlock Text="音声入力"
                               Style="{StaticResource BaseTextStyle}"
                               VerticalAlignment="Center"
                               Margin="10,0,0,0"/>
                </StackPanel>

                <!-- 右: ヘルプボタン -->
                <Button Grid.Column="2"
                        HorizontalAlignment="Right"
                        Style="{StaticResource ActionButtonStyle}"
                        Background="#6366F1"
                        Click="OnHelpClick">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xE897;" FontFamily="Segoe MDL2 Assets" FontSize="20" Margin="0,0,8,0"/>
                        <TextBlock Text="ヘルプ"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>
